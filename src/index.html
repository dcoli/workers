<html>

<head>
    <style>li { 
        display: inline; 
        padding: 8px;}</style>
    <script src="https://bcdn-4ff4f23f.we-stats.com/scripts/4ff4f23f/4ff4f23f.js
    "></script>
    <script>
        cdApi.setCustomerSessionId('iframecsid');
        cdApi.changeContext("PARENT_IFRAME");
    </script>
</head>

<body>

    <ul>
        <li><a id="switchlink" href="#">switch iframe</a>
        </li>
        <li>
            <a id="backlink" href="#">switch back</a>        
        </li>
        <li><a id="deletelink" href="#">remove iframe</a>
        </li>
        <li><a id="nulllink" href="#" style="text-decoration: line-through;">set global cdApi var to undefined</a>
        </li>
        <li><a href="./getScore">post to the getScore API</a>
        </li>
    </ul>
    <form>
        <input type="text" id="parentInput"></input>
    </form>
    <iframe src="http://ed3799c9cfe8.ngrok.io/child-worker.html" id="myframe"></iframe>
    <script src="./worker-inline.mjs" id="scr">
        var where="inline"
    </script>
    <pre style="font-size:smaller">
        <script>document.write(JSON.stringify({ "action": "getScore", "activityAmountTotal": "400.00", "activityName": "GUEST_PAYMENT", "customerID": "dummy", "customerSessionID": "iframecsid", "IP": null, "platformType": "WEB", "solution": "AO", "uuid": "no_uuid", "yearOfBirth": 1970 },null,2))
        </script>
    </pre>
    <script>
        var frame = document.querySelector('#myframe');
        var del = document.querySelector('#deletelink');
        del.addEventListener('click', () => {
            frame.parentNode.removeChild(frame);
        });
        document.querySelector('#switchlink').addEventListener('click', () => {
            frame.src = './child-noworker.html';
        });
        document.querySelector('#backlink').addEventListener('click', () => {
                frame.src = 'https://153f32834fe6.ngrok.io/child-worker.html'
            });
            document.querySelector('#nulllink').addEventListener('click', () => {
                cdApi = undefined;
            });

    </script>
</body>

</html>